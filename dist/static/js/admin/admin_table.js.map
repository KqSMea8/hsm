{"version":3,"sources":["../../../../static/js/admin/admin_table.js"],"names":["getHtml","id","key","ids","$","append","mobj","el","compiled","init","data","tableName","fenye","table","text","add","contents","methods","getRowsCount","keydown","event","obj","scrollTop","target","css","height","_this","dataStr","length","i","TABLE","Util","getInstance","ajax","db","api","controller","CODE","Message","toast","MESSAGE","Math","ceil","parseInt","active","fenyeClick","index","LIMIT","INDEX","hasOwnProperty","JSON","parse","stringify","addClick","confirm","app","publish","imgChange","self","input","attr","FormData","len","files","file","name","xhr","XMLHttpRequest","open","rows","send","onload","json","responseText","isNaN","Api","next","str","parent","find","eq","val","arr","split","console","log","indexOf","parents","join","onerror","err","error","setClick","KEY","deleteClick","evalString","eval"],"mappings":"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","file":"admin_table.js","sourcesContent":["\r\n(function(){\r\n    var getHtml = function(id){\r\n        return `\r\n<style>\r\ntextarea{\r\n    width: 100px;\r\n    height: 50px;\r\n}\r\n</style>\r\n<section id=\"`+id+`_vue\">\r\n    <iframe name=\"nm_iframe\" style=\"display:none;\"></iframe>\r\n    <table class=\"table table-bordered table-striped\">\r\n        <thead>\r\n        <tr>\r\n            <td class=\"{{(item.text=='id'||item.text=='create_time'||item.text=='update_time')?'disn':''}}\" v-for=\"item in table\">{{item.text}}</td>\r\n            <td>操作</td>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <tr>\r\n            <td class=\"{{(item.text=='id'||item.text=='create_time'||item.text=='update_time')?'disn':''}}\" v-for=\"item in table\"><textarea rows=\"1\" type=\"text\" v-model=\"add[item.text]\" @focus=\"keydown($event)\" @keyup=\"keydown($event)\"></textarea></td>\r\n            <td @click=\"addClick()\"><button class=\"btn btn-success\" style=\"width:130px;\">添加</button></td>\r\n        </tr>\r\n        <tr v-for=\"(i, obj) in contents\" title=\"{{i}}\">\r\n            <td class=\"{{(key=='id'||key=='create_time')?'disn':''}}\" v-for=\"(key, value) in obj\" title=\"{{key}}\">\r\n            <!--{{(key=='img')?'readonly = readonly':''}}-->\r\n            <!--style=\"{{(key=='img')?'height:0;width:0;opacity:0;':''}}\"-->\r\n                <textarea cols=\"3\" class=\"input\"  rows=\"1\" type=\"text\" v-model=\"value\" title=\"{{key}}\" @focus=\"keydown($event)\" @keyup=\"keydown($event)\"></textarea>\r\n                <input title=\"0\" style=\"{{(key=='img')?'width:74px;':'display:none;'}}\" type=\"file\" v-on:change=\"imgChange($event, $parent.$index)\">\r\n                <img :src=\"(key=='img'&&(value.split('|'))[0])?(value.split('|'))[0]:''\" style=\"width:100px\" class=\"{{(key=='img')?'':'disn'}}\">\r\n                <input title=\"1\" style=\"{{(key=='img')?'width:74px;':'display:none;'}}\" type=\"file\" v-on:change=\"imgChange($event, $parent.$index)\">\r\n                <img :src=\"(key=='img'&&(value.split('|'))[1])?(value.split('|'))[1]:''\" style=\"width:100px\" class=\"{{(key=='img')?'':'disn'}}\">\r\n                <input title=\"2\" style=\"{{(key=='img')?'width:74px;':'display:none;'}}\" type=\"file\" v-on:change=\"imgChange($event, $parent.$index)\">\r\n                <img :src=\"(key=='img'&&(value.split('|'))[2])?(value.split('|'))[2]:''\" style=\"width:100px\" class=\"{{(key=='img')?'':'disn'}}\">\r\n            </td>\r\n            <td>\r\n                <button @click=\"setClick($index)\" class=\"btn btn-danger\">修改</button>\r\n            &nbsp;&nbsp;&nbsp;&nbsp;\r\n                <button @click=\"deleteClick($index)\" class=\"btn btn-danger\" style=\"padding:0;\">删除</button>\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n    <ul class=\"pagination pagination-lg\">\r\n        <li class=\"{{i.active?'active':''}}\" @click=\"fenyeClick($index)\" v-for=\"i in fenye\"><a href=\"#\">{{i.text}}</a></li>\r\n    </ul>\r\n</section>\r\n`\r\n    };\r\n    for(var key in ids){\r\n        $(\".right-area\").append(getHtml(key));\r\n    }\r\n})();\r\n\r\nvar mobj = {\r\n    el:'',\r\n    compiled:function () {\r\n        this.init();\r\n    },\r\n    data:{\r\n        tableName:'',\r\n        fenye:[],\r\n        table:[\r\n            {text:'name'}\r\n        ],\r\n        add:{},\r\n        contents:[]\r\n    },\r\n    methods:{\r\n        init:function(){\r\n            this.getRowsCount();\r\n        },\r\n        keydown:function(event){\r\n            var obj, scrollTop;\r\n            obj = $(event.target);\r\n            scrollTop = obj.scrollTop();\r\n            if(scrollTop>0){\r\n                obj.css('height',obj.height() + scrollTop + 20 );\r\n            }\r\n        },\r\n        getRowsCount:function(){\r\n            var _this = this;\r\n            var dataStr, length, i;\r\n            dataStr = '{' +\r\n                '\"'+TABLE+'\":\"'+this.tableName+'\"' +\r\n                '}';\r\n            Util.getInstance().ajax(dataStr, db.data.api+'?r='+controller+'/Get_obj_count', function(data){\r\n                if (data[CODE] !== 0) {\r\n                    Message.getInstance().toast(data[MESSAGE], 3);\r\n                } else {\r\n                    length = Math.ceil(parseInt(data[MESSAGE])/10);\r\n                    if(length === 0){\r\n                        length = 1;\r\n                    }\r\n                    _this.fenye = [];\r\n                    for(i=0;i<length;i++){\r\n                        _this.fenye[i] = {text:i+1,active:false};\r\n                    }\r\n                    _this.fenyeClick(0);\r\n                }\r\n            });\r\n        },\r\n        fenyeClick:function(index){\r\n            var _this = this;\r\n            var i, dataStr, key;\r\n            for(i=0;i<this.fenye.length;i++){\r\n                _this.fenye[i].active = false;\r\n            }\r\n            _this.fenye[index].active = true;\r\n            dataStr = '{' +\r\n                '\"'+LIMIT+'\":\"'+10+'\",' +\r\n                '\"'+INDEX+'\":\"'+index+'\",' +\r\n                '\"'+TABLE+'\":\"'+this.tableName+'\"' +\r\n                '}';\r\n            Util.getInstance().ajax(dataStr, db.data.api+'?r='+controller+'/Get_obj_arr', function(data){\r\n                if (data[CODE] !== 0) {\r\n                    Message.getInstance().toast(data[MESSAGE], 3);\r\n                } else {\r\n                    _this.contents = data[MESSAGE];\r\n                    i = 0;\r\n                    for(key in _this.contents[0]){\r\n                        if(_this.contents[0].hasOwnProperty(key)){\r\n                            _this.table[i] = {text:key};\r\n                            i++;\r\n                        }\r\n                    }\r\n                    _this.table = JSON.parse(JSON.stringify(_this.table));\r\n                }\r\n            });\r\n        },\r\n        addClick:function(){\r\n            if(!confirm(\"确定要添加该条数据吗\"))\r\n                return false;\r\n            var dataStr;\r\n            dataStr = '{' +\r\n                '\"'+TABLE+'\":\"'+this.tableName+'\",' +\r\n                '\"'+MESSAGE+'\":'+JSON.stringify(this.add)+'' +\r\n                '}';\r\n            var _this = this;\r\n            Util.getInstance().ajax(dataStr, db.data.api+'?r='+controller+'/Add_obj', function(data){\r\n                if (data[CODE] !== 0) {\r\n                    Message.getInstance().toast(data[MESSAGE], 3);\r\n                } else {\r\n                    _this.fenyeClick(this.fenye.length-1);\r\n                    Message.getInstance().toast('添加成功');\r\n                    app.publish('add_one_callBack');\r\n                }\r\n            });\r\n        },\r\n        imgChange:function(event, index){\r\n            var self = this;\r\n            var input = event.target;\r\n            var index = $(input).attr('title');\r\n            // var form = input.parentElement;\r\n            var data = new FormData();\r\n            for (var i = 0, len = input.files.length; i < len; i++) {\r\n                //file property: name, size, type, lastModifiedDate\r\n                var file = input.files[i];\r\n                data.append(file.name, file);\r\n            }\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open('post', db.data.api+'?r='+controller+'/set_img&id='+this.rows[index].id+'&t='+this.tableName, true);\r\n            xhr.send(data);\r\n            xhr.onload = function () {\r\n                var json = JSON.parse(xhr.responseText);\r\n                if(!isNaN(json[Api.CODE])){\r\n                    Message.getInstance().toast(json[Api.MESSAGE]);\r\n                    return;\r\n                }\r\n                $(input).next().attr('src',xhr.responseText);\r\n                var str = $(input).parent().find('.input').eq(0).val();\r\n                var arr = str.split('|');\r\n                console.log(arr);\r\n                if(str.indexOf('|') <0 ){\r\n                    arr = ['','',''];\r\n                }\r\n                arr[index] = xhr.responseText;\r\n                console.log(arr);\r\n                var i = $(input).parents('tr').attr('title');\r\n                var key = $(input).parents('td').attr('title');\r\n                self.contents[i][key] = arr.join('|');\r\n            };\r\n            xhr.onerror = function (err) {\r\n                console.error(err);\r\n            };\r\n        },\r\n        setClick:function(index){\r\n            if(!confirm(\"确定要修改该条数据吗\"))\r\n                return false;\r\n            var dataStr;\r\n            dataStr = '{' +\r\n                '\"'+TABLE+'\":\"'+this.tableName+'\",' +\r\n                '\"'+KEY+'\":{\"id\":\"'+this.contents[index]['id']+'\"},' +\r\n                '\"'+MESSAGE+'\":'+JSON.stringify(this.contents[index])+\r\n                '}';\r\n            Util.getInstance().ajax(dataStr, db.data.api+'?r='+controller+'/Update_obj', function(data){\r\n                if (data[CODE] !== 0) {\r\n                    Message.getInstance().toast(data[MESSAGE], 3);\r\n                } else {\r\n                    Message.getInstance().toast('修改成功');\r\n                    app.publish('set_one_callBack');\r\n                }\r\n            });\r\n        },\r\n        deleteClick:function(index){\r\n            if(!confirm(\"确定要删除！！！！\"))\r\n                return false;\r\n            var dataStr, length, i;\r\n            dataStr = '{' +\r\n                '\"'+TABLE+'\":\"'+this.tableName+'\",' +\r\n                '\"'+KEY+'\":{\"id\":\"'+this.contents[index]['id']+'\"}'+\r\n                '}';\r\n            var _this = this;\r\n            Util.getInstance().ajax(dataStr, db.data.api+'?r='+controller+'/Remove_obj', function(data){\r\n                if (data[CODE] !== 0) {\r\n                    Message.getInstance().toast(data[MESSAGE], 3);\r\n                } else {\r\n                    Message.getInstance().toast('删除成功');\r\n                    app.publish('delete_one_callBack');\r\n                    length = _this.fenye.length;\r\n                    for(i=0;i<length; i++){\r\n                        if(_this.fenye[i].active === true){\r\n                            _this.fenyeClick(i);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\nvar key,evalString;\r\nfor(key in ids){\r\n    if(ids.hasOwnProperty(key)){\r\n        evalString = `\r\n var `+key+` = (function(mobj){\r\n     var mo = Util.getInstance().clone(mobj);\r\n     mo.el = '#`+key+`_vue';\r\n     mo.data.tableName = '`+ids[key]['tableName']+`';\r\nfunction a(){}\r\na.getInstance = function () {\r\n    if (!this.self) {\r\n        this.self = new a();\r\n    }\r\n    return this.self;\r\n};\r\na.prototype.vue = null;\r\na.prototype.hash = '';\r\na.prototype.vue_ = function(){\r\n    this.vue = new VueP(mo);\r\n};\r\nreturn a;\r\n}(mobj));\r\n \r\n`;\r\n        // console.log(evalString);\r\n        eval(evalString);\r\n    }\r\n}\r\n"]}