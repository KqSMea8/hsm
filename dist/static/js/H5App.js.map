{"version":3,"sources":["../../../static/js/H5App.js"],"names":["__extends","H5App","App","config","_this","call","APP_EVENT_BEGIN_RIGHT_TO_LEFT","APP_EVENT_BEGIN_LEFT_TO_RIGHT","APP_EVENT_TRANSITION_END","APP_EVENT_LOGOUT","APP_EVENT_LOAD_SESSIONID","pageName","prototype","doPull","modal","console","log","stacks","push","nextActive","getJqModal","show","loadModal","publish","APP_EVENT_ANIMATION_BEGIN","doAnimation","nowActive","isfirst","wait","length","setTimeout","pop","hashChange","hash","defaultHash","lastHash","mainHash","hashGoBack","pull","noDie","Message","dialog","functionApi","removeDialog","sectionTransitionEnd","event","obj","target","propertyName","tagName","transitionTag","toUpperCase","run","self","location","ready","func","callBack","Util","isWeChat","app","browser","url","base64encode","$","append","remove","jump2","err","db","data","history","JSON","stringify","toast","init","split","each","id","attr","css","val"],"mappings":"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","file":"H5App.js","sourcesContent":["__extends(H5App, App);\r\nfunction H5App(config) {\r\n    var _this;\r\n    _this = App.call(this, config) || this;\r\n\r\n    _this.APP_EVENT_BEGIN_RIGHT_TO_LEFT = 'APP_EVENT_BEGIN_RIGHT_TO_LEFT';\r\n    _this.APP_EVENT_BEGIN_LEFT_TO_RIGHT = 'APP_EVENT_BEGIN_LEFT_TO_RIGHT';\r\n    _this.APP_EVENT_TRANSITION_END = 'APP_EVENT_TRANSITION_END';\r\n    _this.APP_EVENT_LOGOUT = 'APP_EVENT_LOGOUT';\r\n    _this.APP_EVENT_LOAD_SESSIONID = 'APP_EVENT_LOAD_SESSIONID';\r\n    _this.pageName = '';\r\n    return _this;\r\n}\r\nH5App.prototype.doPull = function (modal) {\r\n    console.log('do pull : ' + modal);\r\n    this.stacks.push(modal);\r\n    var nextActive = this.getJqModal(modal);\r\n    nextActive.show();\r\n    this.loadModal(modal);\r\n    this.publish(this.APP_EVENT_ANIMATION_BEGIN);\r\n};\r\nH5App.prototype.doAnimation = function (nowActive, nextActive, isfirst) {\r\n    var _this = this;\r\n    var wait;\r\n    if (nextActive == _this.getJqModal(_this.stacks[_this.stacks.length - 3])) {\r\n        setTimeout(function () {\r\n            _this.publish(_this.APP_EVENT_BEGIN_LEFT_TO_RIGHT);\r\n            _this.stacks.pop();\r\n            _this.stacks.pop();\r\n        }, 0);\r\n    }else {\r\n        if(isfirst){\r\n            wait = 150;\r\n        }else{\r\n            wait = 50;\r\n        }\r\n        setTimeout(function () {\r\n            _this.publish(_this.APP_EVENT_BEGIN_RIGHT_TO_LEFT);\r\n        }, wait);\r\n    }\r\n};\r\nH5App.prototype.hashChange = function (hash) {\r\n    var _this = this;\r\n    //app.publish(APP_EVENT_HASH_CHANGE);\r\n    if (this.stacks.length && hash == this.defaultHash) {\r\n        console.log('this.lastHash');\r\n        console.log(this.lastHash);\r\n        if(this.stacks.length<=2 && this.lastHash !== this.mainHash){\r\n            this.lastHash = this.mainHash;\r\n            this.hashGoBack(this.mainHash);\r\n            this.pull(this.mainHash);\r\n            return;\r\n        }\r\n\r\n        if (this.noDie) {\r\n            this.hashGoBack(this.lastHash);\r\n        }else {\r\n            Message.dialog('提醒', \"是否要退出应用程序\", '确定', '取消', function () {\r\n                _this.functionApi('die');\r\n                Message.removeDialog();\r\n            }, function () {\r\n                _this.hashGoBack(_this.lastHash);\r\n                Message.removeDialog();\r\n            });\r\n        }\r\n    }\r\n    else {\r\n        this.lastHash = hash;\r\n        // this.pull(hash + '_vue');\r\n        this.pull(hash);\r\n    }\r\n};\r\nH5App.prototype.sectionTransitionEnd = function (event) {\r\n    var obj = event.target;\r\n    if ((event.propertyName == '-webkit-transform' || event.propertyName == 'transform') && obj.tagName == this.transitionTag.toUpperCase()) {\r\n        this.publish(this.APP_EVENT_TRANSITION_END);\r\n    }\r\n};\r\nH5App.prototype.run = function () {\r\n    var _this = this;\r\n    var self = this;\r\n    setTimeout(function () {\r\n        console.log('the first hash is : ' + _this.defaultHash);\r\n        location.hash = self.defaultHash;\r\n        setTimeout(function(){\r\n            _this.ready = true;\r\n        },400);\r\n    }, 100);\r\n};\r\nH5App.prototype.functionApi = function (func, callBack) {\r\n    if (callBack === void 0) { callBack = ''; }\r\n    if (Util.isWeChat()) {\r\n        app.browser[func]()\r\n    }\r\n    else {\r\n        var url = \"function://\" + Util.base64encode(func + '-' + callBack);\r\n        $('body').append('<iframe id=\"functionApi\" class=\"disn\" src=\"' + url + '\"></iframe>');\r\n        setTimeout(function () {\r\n            $('#functionApi').remove();\r\n        }, 100);\r\n    }\r\n};\r\nH5App.prototype.jump2 = function (pageName) {\r\n    try {\r\n        if (!pageName)\r\n            return;\r\n        location.hash = pageName;\r\n    }\r\n    catch (err) {\r\n        location.hash = pageName;\r\n    }\r\n};\r\nH5App.prototype.push = function (pageName) {\r\n    db.data.history.push(pageName);\r\n    this.functionApi('setDbJson', JSON.stringify(db.data));\r\n    this.functionApi('pushPage', pageName);\r\n};\r\nH5App.prototype.pop = function () {\r\n    if (db.data.history.length - 2 >= 0) {\r\n        db.data.history.pop();\r\n        this.functionApi('setDbJson', JSON.stringify(db.data));\r\n        this.functionApi('popPage', db.data.history[db.data.history.length - 1]);\r\n    }\r\n    else {\r\n        Message.toast('是否要退出软件？', 2);\r\n    }\r\n};\r\nH5App.prototype.init = function () {\r\n    var _this = this;\r\n    this.pageName = location.hash.split(\"#\")[1];\r\n    $('section').each(function () {\r\n        var id = $(_this).attr('id');\r\n        if (id == _this.pageName + \"_vue\") {\r\n            $(_this).css({\r\n                '-webkit-transform': 'translate(0,0)',\r\n                'transform': 'translate(0,0)'\r\n            }).show();\r\n            return;\r\n        }\r\n    });\r\n    try {\r\n        let val = this.pageName + \"_vue\"\r\n        console.log(this.pageName + \"_vue();\");\r\n        _this[val]();\r\n    }\r\n    catch (err) {\r\n        console.log(err);\r\n    }\r\n};\r\n"]}