{"version":3,"sources":["../../../static/js/App.js"],"names":["App","config","APP_EVENT_ANIMATION_END","APP_EVENT_ANIMATION_BEGIN","APP_EVENT_HASH_CHANGE","isDoingAnimation","oprationStacks","createTime","Date","$modals","stacks","noDie","projectName","lastHash","defaultHash","secondHash","mainHash","isDebug","isIos","transitionTag","transitionName","transitionTime","transitionType","maxZindex","reSetHash","initBind","initView","prototype","loadCss","addr","addString","getTime","str","i","length","$","append","getJqModal","modal","obj","doPull","pull","console","log","push","loadModal","db","data","window","vue","init","doAnimation","Util","hasLoadJsCallBack","nowActive","nextActive","isfirst","hashGoBack","hash","subscribe","func","bind","publish","trigger","unSubscribe","unbind","sectionTransitionEnd","event","_this","body","addEventListener","e","attachEvent","setTimeout","remove","app","css","hashChange","$window","location","substr"],"mappings":"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","file":"App.js","sourcesContent":["\r\nvar App = function(config) {\r\n    this.APP_EVENT_ANIMATION_END = 'APP_EVENT_ANIMATION_END';\r\n    this.APP_EVENT_ANIMATION_BEGIN = 'APP_EVENT_ANIMATION_BEGIN';\r\n    this.APP_EVENT_HASH_CHANGE = 'APP_EVENT_HASH_CHANGE';\r\n    this.isDoingAnimation = false;\r\n    this.oprationStacks = [];\r\n    this.createTime = new Date();\r\n    this.$modals = {};\r\n    this.stacks = [];\r\n    this.noDie = false;\r\n    this.projectName = '';\r\n    this.lastHash = '';\r\n    this.defaultHash = null;\r\n    this.secondHash = null;\r\n    this.mainHash = null;\r\n    this.isDebug = null;\r\n    this.isIos = false;\r\n    this.transitionTag = null;\r\n    this.transitionName = null;\r\n    this.transitionTime = null;\r\n    this.transitionType = null;\r\n    this.maxZindex = 100;\r\n    this.defaultHash = config['defaultHash']?config['defaultHash']:'launcher';\r\n    this.secondHash = config['secondHash']?config['secondHash']:'index';\r\n    this.mainHash = config['mainHash']?config['mainHash']:'index';\r\n    this.isDebug = config['isDebug'];\r\n    this.transitionTag = config['transitionTag']?config['transitionTag']:'section';\r\n    this.transitionName = config['transitionName']?config['transitionName']:'all';\r\n    this.transitionTime = config['transitionTime']?config['transitionTime']:'0';\r\n    this.transitionType = config['transitionType']?config['transitionType']:'ease';\r\n    this.projectName = config['projectName']?config['projectName']:'myapp';\r\n    this.reSetHash('');\r\n    this.initBind();\r\n    this.initView();\r\n};\r\n\r\nApp.prototype.loadCss = function (addr) {\r\n    var addString = (this.isDebug) ? '?time=' + this.createTime.getTime() : '';\r\n    var str = '';\r\n    var i;\r\n    for (i = 0; i < addr.length; i++) {\r\n        str += '<link rel=\"stylesheet\" href=\"' + addr[i] + addString + '\" type=\"text/css\"/>';\r\n    }\r\n    $('body').append(str);\r\n};\r\nApp.prototype.getJqModal = function (modal) {\r\n    modal += '_vue';\r\n    if (!modal) {\r\n        return '';\r\n    }\r\n    else {\r\n        if (this.$modals[modal]) {\r\n            return this.$modals[modal];\r\n        }\r\n        else {\r\n            var obj = $('#' + modal);\r\n            this.$modals[modal] = obj;\r\n            return obj;\r\n        }\r\n    }\r\n};\r\nApp.prototype.doPull = function (modal) { };\r\nApp.prototype.pull = function (modal) {\r\n    console.log('pull ' + modal);\r\n    if (this.isDoingAnimation) {\r\n        this.oprationStacks.push(modal);\r\n        return false;\r\n    }else {\r\n        this.isDoingAnimation = true;\r\n        this.doPull(modal);\r\n    }\r\n    // if (modal == this.defaultHash + \"_vue\") {\r\n    if (modal === this.defaultHash) {\r\n        this.isDoingAnimation = false;\r\n        if (this.defaultHash !== 'launcher') {\r\n            this.defaultHash = 'launcher';\r\n        }\r\n    }\r\n};\r\nApp.prototype.loadModal = function (modal) {\r\n    console.log('loadModal:'+modal);\r\n    if (db.data.isIos){\r\n        if (modal === 'index'){\r\n            window[modal].vue.init();\r\n            if(!!this.stacks[this.stacks.length - 2] === false)\r\n                this.doAnimation(null, this.getJqModal(this.stacks[this.stacks.length - 1]), false);\r\n            else\r\n                this.doAnimation(this.getJqModal(this.stacks[this.stacks.length - 2]), this.getJqModal(this.stacks[this.stacks.length - 1]), false);\r\n            return\r\n        }\r\n    }\r\n    Util.hasLoadJsCallBack(modal+'.vue',()=>{\r\n        window[modal].vue.init();\r\n        if(!!this.stacks[this.stacks.length - 2] === false)\r\n            this.doAnimation(null, this.getJqModal(this.stacks[this.stacks.length - 1]), false);\r\n        else\r\n            this.doAnimation(this.getJqModal(this.stacks[this.stacks.length - 2]), this.getJqModal(this.stacks[this.stacks.length - 1]), false);\r\n    });\r\n};\r\nApp.prototype.doAnimation = function (nowActive, nextActive, isfirst) {};\r\n/**\r\n * 取消推出的时候 用来返回hash的\r\n * @param hash\r\n */\r\nApp.prototype.hashGoBack = function (hash) {\r\n    this.reSetHash(hash);\r\n};\r\nApp.prototype.subscribe = function (str, func) {\r\n    $('title').bind(str, func);\r\n};\r\nApp.prototype.publish = function (str) {\r\n    $('title').trigger(str);\r\n};\r\nApp.prototype.unSubscribe = function (str) {\r\n    $('title').unbind(str);\r\n};\r\nApp.prototype.sectionTransitionEnd = function (event) { };\r\nApp.prototype.initBind = function () {\r\n    var _this = this;\r\n    var body = $('body')[0];\r\n    try {\r\n        body.addEventListener(\"transitionend\", function (event) {\r\n            _this.sectionTransitionEnd(event);\r\n        });\r\n    }\r\n    catch (e) {\r\n        console.log('addEventListener has Error:' + e);\r\n        try {\r\n            body.attachEvent(\"transitionend\", function (event) {\r\n                this.sectionTransitionEnd(event);\r\n            });\r\n        } catch (e) {\r\n            console.log('attachEvent has Error:' + e);\r\n        }\r\n    }\r\n    this.subscribe(this.APP_EVENT_ANIMATION_END, function () {\r\n        if (_this.oprationStacks.length) {\r\n            console.log('opration modal : ' + _this.oprationStacks[0]);\r\n            setTimeout(function () {\r\n                _this.pull(_this.oprationStacks[0]);\r\n                _this.oprationStacks.remove(0);\r\n            }, 0);\r\n        }\r\n\r\n        console.log(app.mainHash == app.lastHash);\r\n        if(app.stacks[1] != app.mainHash && app.stacks.length==3 && app.mainHash == app.lastHash){\r\n            app.getJqModal(app.stacks[1]).css({\r\n                '-webkit-transform':'translate(100%, 0)',\r\n                'transform':'translate(100%, 0)',\r\n                'display':'none',\r\n            });\r\n            app.stacks = [app.defaultHash, app.mainHash];\r\n        }\r\n    });\r\n};\r\nApp.prototype.initView = function () {\r\n    $('section').css({\r\n        '-webkit-transition': 'all 0.3s ease',\r\n    });\r\n};\r\nApp.prototype.hashChange = function (hash) {};\r\nApp.prototype.reSetHash = function (hash) {\r\n    var _this = this;\r\n    var $window = $(window);\r\n    $window.unbind('hashchange');\r\n    location.hash = hash;\r\n    setTimeout(function () {\r\n        $window.bind('hashchange', function () {\r\n            var hash = location.hash.substr(1, location.hash.length - 1);\r\n            console.log('hashchange:' + hash);\r\n            if (!hash) {\r\n                return false;\r\n            } else {\r\n                _this.hashChange(hash);\r\n            }\r\n        });\r\n    }, 300);\r\n};"]}